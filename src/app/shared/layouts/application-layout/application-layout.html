<!-- src/app/layout/app-layout.component.html -->
<div class="h-dvh min-h-screen bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100">

  <!-- Top bar -->
  <header
    class="sticky top-0 z-20 flex items-center gap-2 border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-900/80 backdrop-blur px-3 sm:px-4 h-14">
    <!-- Mobile hamburger -->
    <button class="p-2 sm:hidden rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
            (click)="openDrawer()" aria-label="Open navigation">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path [attr.d]="'bars-3' | heroIconHelper" stroke-width="1.5" stroke-linecap="round"
              stroke-linejoin="round"></path>
      </svg>
    </button>

    <!-- Desktop collapse -->
    <button class="hidden sm:inline-flex p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
            (click)="toggleSidebar()" aria-label="Toggle sidebar">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        @for (
          d of (collapsed() ? ('chevron-double-right' | heroIconHelper) : ('chevron-double-left' | heroIconHelper)); track $index) {
          <ng-container>
            <path [attr.d]="d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          </ng-container>
        }

      </svg>
    </button>

    <div class="font-semibold tracking-tight">My App</div>
    <div class="ml-auto flex items-center gap-3">
      <!-- put profile menu, notifications, etc. here -->
      <app-layout-notifications />
    </div>
  </header>

  <div class="relative">
    <!-- Desktop sidebar -->
    <aside class="hidden sm:block fixed top-14 bottom-0 border-r border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-950
                   transition-all duration-200 ease-in-out"
           [class.w-64]="!collapsed()"
           [class.w-16]="collapsed()">
      <nav class="h-full overflow-y-auto">
        <ul class="py-3">
          @for (navigationItem of navigations; track navigationItem.route) {
            <li>
              <a [routerLink]="navigationItem.route"
                 routerLinkActive="bg-gray-100 dark:bg-gray-800"
                 [routerLinkActiveOptions]="{ exact: navigationItem.route === '/' }"
                 class="mx-2 my-1 flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
                <!-- icon -->
                <svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  @for (d of navigationItem.icon; track d) {
                    <ng-container>
                      <path [attr.d]="d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                    </ng-container>
                  }
                </svg>
                <!-- label -->
                <span class="whitespace-nowrap overflow-hidden transition-all"
                      [class.opacity-0]="collapsed()"
                      [class.w-0]="collapsed()"
                      [class.w-40]="!collapsed()">
                  {{ navigationItem.label }}
                </span>
              </a>
            </li>
          }
        </ul>
      </nav>
    </aside>

    <!-- Mobile drawer overlay -->
    @if (drawerOpened()) {
      <div
        class="sm:hidden fixed inset-0 z-30 bg-black/40"
        (click)="closeDrawer()"
        (keydown.enter)="closeDrawer()"
        (keydown.space)="closeDrawer()"
        tabindex="0"
        aria-label="Close navigation overlay"
      >

      </div>
      <aside
        class="sm:hidden fixed inset-y-0 left-0 z-40 w-72 bg-white dark:bg-gray-950 border-r border-gray-200 dark:border-gray-800 p-3">
        <button class="mb-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800" (click)="closeDrawer()"
                aria-label="Close navigation">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="size-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
          </svg>
        </button>
        <nav>
          <ul>
            @for (navigationItem of navigations; track navigationItem.route) {
              <li>
                <a [routerLink]="navigationItem.route" (click)="closeDrawer()"
                   routerLinkActive="bg-gray-100 dark:bg-gray-800"
                   [routerLinkActiveOptions]="{ exact: navigationItem.route === '/' }"
                   class="my-1 flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800">
                  <!-- icon -->
                  <svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    @for (d of navigationItem.icon; track d) {
                      <ng-container>
                        <path [attr.d]="d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                      </ng-container>
                    }
                  </svg>
                  <span>{{ navigationItem.label }}</span>
                </a>
              </li>
            }
          </ul>
        </nav>
      </aside>
    }

    <!-- Content area -->
    <main class="transition-all duration-200 ease-in-out pt-4 px-3 sm:px-6"
          [class.sm:ml-64]="!collapsed()"
          [class.sm:ml-16]="collapsed()">
      <router-outlet />
    </main>
  </div>
</div>
